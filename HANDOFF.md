# COMPASS í”„ë¡œì íŠ¸ í•¸ë“œì˜¤í”„ ë¬¸ì„œ

> **ìµœì¢… ì—…ë°ì´íŠ¸**: 2026-02-19 (1-5 Step 4 ì™„ë£Œ + ì»¤ë°‹/push ì™„ë£Œ, **Step 5 ì‹œì‘ ëŒ€ê¸°**)
> **ê·œì¹™Â·ì›Œí¬í”Œë¡œìš°**: `CLAUDE.md` | **ë°˜ë³µ ì‹¤ìˆ˜Â·êµí›ˆ**: `MEMORY.md`

---

## 1. í”„ë¡œì íŠ¸ ê°œìš”

**COMPASS** â€” í•œêµ­ í•™ì›ì„ ìœ„í•œ AI ê¸°ë°˜ í•™êµë³„ ì˜ˆìƒì‹œí—˜ ìƒì„± í”Œë«í¼ (B2B2C)

ê¸°ìˆ ìŠ¤íƒ: Next.js 16.1.6 + React 19 + Supabase + Google Gemini + Vercel

---

## 2. í˜„ì¬ ì§„í–‰ ìƒí™©

### Phase 0 (100% ì™„ë£Œ)
- 0-1~0-4: Next.js + Supabase + ë ˆì´ì•„ì›ƒ + ê³µí†µ UI
- 0-5: AI ì¶”ìƒí™” ë ˆì´ì–´ (Factory + Strategy, GeminiProvider, 94ê°œ+ í…ŒìŠ¤íŠ¸)

### ë‹¨ê³„ 1: ê¸°ì¶œ ê¸°ë°˜ ë¬¸ì œ ìƒì„± + ì¸ì¦ (55% ì™„ë£Œ)

| ìŠ¤í… | ì‘ì—… | ìƒíƒœ |
|------|------|------|
| 1-1 | ì¸ì¦ ì‹œìŠ¤í…œ [F010] | âœ… ì™„ë£Œ |
| 1-2 | ê¸°ì¶œë¬¸ì œ ì—…ë¡œë“œ [F005] | âœ… ì™„ë£Œ |
| 1-3 | í•™êµ ê´€ë¦¬ CRUD [F008] | âœ… ì™„ë£Œ |
| 1-4 | í•™ì› ê´€ë¦¬ CRUD [F007] | âœ… ì™„ë£Œ |
| **1-5** | **ì‚¬ìš©ì ê´€ë¦¬ CRUD [F009]** | **ğŸš§ Step 4/5 ì™„ë£Œ** |
| 1-6 | ê¸°ì¶œë¬¸ì œ ì¡°íšŒ [F006] | ë¯¸ì‹œì‘ |
| 1-7 | ê¸°ì¶œ ê¸°ë°˜ AI ë¬¸ì œ ìƒì„± [F011] | ë¯¸ì‹œì‘ |
| 1-8 | ìƒì„±ëœ ë¬¸ì œ ì €ì¥ [F003] | ë¯¸ì‹œì‘ |

### 1-5 ì„¸ë¶€ ì§„í–‰

| Step | ë‚´ìš© | í•™ìŠµ ë“±ê¸‰ | ìƒíƒœ |
|------|------|----------|------|
| 1 | Zod ê²€ì¦ ìŠ¤í‚¤ë§ˆ (TDD) | ğŸŸ¢ | âœ… ì™„ë£Œ |
| 2 | Server Actions (TDD) | ğŸ”´ | âœ… êµ¬í˜„ + í•™ìŠµ ë¦¬ë·° ì™„ë£Œ |
| 3 | DataTable + ëª©ë¡ í˜ì´ì§€ UI | ğŸŸ¡ | âœ… êµ¬í˜„ + í•™ìŠµ ë¦¬ë·° ì™„ë£Œ |
| 4 | ì—­í•  ë³€ê²½ Dialog + ìƒì„¸ Sheet | ğŸŸ¡ | âœ… êµ¬í˜„ + í•™ìŠµ ë¦¬ë·° ì™„ë£Œ |
| **5** | **ë©”ë‰´ + ë¹Œë“œ ê²€ì¦ + í•™ìŠµ ë¦¬ë·°** | **-** | **â³ ë‹¤ìŒ ì‘ì—…** |

### ìµœê·¼ ì„¸ì…˜ (2026-02-19)
1. Step 4 ì—­í•  ë³€ê²½ AlertDialog + ì‚¬ìš©ì ìƒì„¸ Sheet êµ¬í˜„ â€” ë¹Œë“œ ì„±ê³µ, 300ê°œ í…ŒìŠ¤íŠ¸ íšŒê·€ ì—†ìŒ
2. í•™ìŠµ ë¦¬ë·°: AlertDialog vs Dialog, Controlled Dialog, Sheet íŒ¨í„´, UI í•„í„°ë§ â‰  ë³´ì•ˆ
3. ë¹ˆì¹¸ ì±„ìš°ê¸° ì§ì ‘ êµ¬í˜„ ì™„ë£Œ (role-change-dialog.tsx) â€” await ëˆ„ë½, í…œí”Œë¦¿ ë¦¬í„°ëŸ´, JSX í‘œí˜„ì‹ ë²„ê·¸ ì§ì ‘ ìˆ˜ì •
4. ë¬¸ì„œ ì—…ë°ì´íŠ¸ (ROADMAP, HANDOFF, plan) + `/docs:update-roadmap` ì»¤ë§¨ë“œ ìŠ¤í…ë³„ ê³„íš ë¬¸ì„œ íƒìƒ‰ ê°œì„ 
5. 3ê°œ ì»¤ë°‹ + push ì™„ë£Œ (`b0715d9`, `9ac00a8`, `b2da290`)

---

## 3. ë‹¤ìŒ ì‘ì—…

### ì¦‰ì‹œ: 1-5 Step 5 â€” ì‚¬ì´ë“œë°” ë©”ë‰´ + ë¹Œë“œ ê²€ì¦ + ìµœì¢… í•™ìŠµ ë¦¬ë·°

**ê³„íš**: `docs/plan/phase-1-step5-user-crud.md` Step 5 ì„¹ì…˜

**êµ¬í˜„ ëŒ€ìƒ**:
- `src/lib/constants/menu.ts` â€” "ì‚¬ìš©ì ê´€ë¦¬" (`/admin/users`) ë©”ë‰´ í•­ëª© ì¶”ê°€
- ì•„ì´ì½˜: `Users` (lucide-react), ìœ„ì¹˜: í•™ì› ê´€ë¦¬ ì•„ë˜

**Phase B: ë¹Œë“œ ê²€ì¦**:
```bash
npm run test:run  # ì „ì²´ í…ŒìŠ¤íŠ¸
npm run lint      # ì—ëŸ¬ 0ê°œ
npm run build     # ë¹Œë“œ ì„±ê³µ
```

**Phase C: ìµœì¢… í•™ìŠµ ë¦¬ë·°** (1-5 ì „ì²´ íšŒê³ )

### ì´í›„
- 1-6: ê¸°ì¶œë¬¸ì œ ì¡°íšŒ â†’ 1-7: AI ë¬¸ì œ ìƒì„± â†’ 1-8: ë¬¸ì œ ì €ì¥

---

## 4. ì„±ê³µí•œ ì ‘ê·¼ (ì¬ì‚¬ìš©í•  íŒ¨í„´)

### ê°œë°œ íŒ¨í„´
- **Defense in Depth**: RLS + Server Action + Zod 3ì¤‘ ê¶Œí•œ ì²´í¬
- **Self-referencing ID**: academy_idë¥¼ profileì—ì„œ ì¶”ì¶œ â†’ URL ì¡°ì‘ ë°©ì§€
- **`useTransition` + Server Actions**: ì§ì ‘ ê²°ê³¼ í•¸ë“¤ë§, isPendingìœ¼ë¡œ ì¤‘ë³µ í´ë¦­ ë°©ì§€
- **Server Componentì—ì„œ ì—­í•  ë¶„ê¸°**: DevTools ìš°íšŒ ë°©ì§€, ë²ˆë“¤ í¬ê¸° ì ˆê°
- **createUserColumns íŒ©í† ë¦¬ í•¨ìˆ˜**: í˜¸ì¶œì ê¶Œí•œì— ë”°ë¼ ë‹¤ë¥¸ ì»¬ëŸ¼ ë°°ì—´ ë°˜í™˜
- **URL searchParams ê¸°ë°˜ ìƒíƒœ ê´€ë¦¬**: ë¶ë§ˆí¬/ê³µìœ /ë’¤ë¡œê°€ê¸° ìì—° ì§€ì›
- **Controlled AlertDialog**: DropdownMenu ì™¸ë¶€ Fragmentì— ë°°ì¹˜ â†’ Radix í¬ì»¤ìŠ¤ ì¶©ëŒ ë°©ì§€
- **TDD REDâ†’GREENâ†’REFACTOR** ì² ì € ì¤€ìˆ˜

### í•™ìŠµ ë°©ë²•
- **ë¹ˆì¹¸ ì±„ìš°ê¸° ë°©ì‹ ì¬êµ¬í˜„**: ì „ì²´ ì‚­ì œê°€ ì•„ë‹Œ í•µì‹¬ ë¡œì§ë§Œ ë¹ˆì¹¸
- **ì‚¬ìš©ì ìˆ˜ì¤€**: JavaScript ê¸°ì´ˆ(`const`, `await`)ë¶€í„° ì„¤ëª… í•„ìš”. ê°„ê²°í•˜ê²Œ
- **ì—ì´ì „íŠ¸ ì»¤ë§¨ë“œ ì¤€ìˆ˜**: `/plan`, `/tdd` ë“± ëª…ì‹œëœ ê²½ìš° ë°˜ë“œì‹œ í•´ë‹¹ ì„œë¸Œì—ì´ì „íŠ¸ ì‹¤í–‰

### ë„êµ¬ í™œìš©
- **ë³‘ë ¬ ì—ì´ì „íŠ¸**: ui-markup-specialist + nextjs-supabase-expert ë™ì‹œ ì‹¤í–‰
- **TDD ì§ì ‘ êµ¬í˜„**: Task ì—ì´ì „íŠ¸ ì—†ì´ í•„ë¦½ì´ ì§ì ‘ REDâ†’GREEN (ì‚¬ìš©ì ì„ í˜¸)

---

## 5. í•µì‹¬ ì°¸ì¡° ë¬¸ì„œ

| ìš°ì„ ìˆœìœ„ | ë¬¸ì„œ |
|---------|------|
| 1 | `CLAUDE.md` â€” ê·œì¹™Â·ì›Œí¬í”Œë¡œìš° |
| 2 | `MEMORY.md` â€” ë°˜ë³µ ì‹¤ìˆ˜Â·ê¸°ìˆ  êµí›ˆ |
| 3 | `ROADMAP.md` â€” ìˆœì°¨ ìŠ¤í…ë³„ ë¡œë“œë§µ |
| 4 | `docs/plan/phase-1-step5-user-crud.md` â€” 1-5 ì „ì²´ ê³„íš |
| 5 | `docs/design/ì‹œìŠ¤í…œì•„í‚¤í…ì²˜.md` â€” ì•„í‚¤í…ì²˜, DB ìŠ¤í‚¤ë§ˆ |
| 6 | `PRD.md` â€” ê¸°ëŠ¥ ëª…ì„¸ |

### 1-5 í•µì‹¬ êµ¬í˜„ íŒŒì¼

- `src/lib/actions/users.ts` â€” Server Actions (390ì¤„)
- `src/lib/actions/__tests__/users.test.ts` â€” 28ê°œ í…ŒìŠ¤íŠ¸ (626ì¤„)
- `src/lib/validations/users.ts` â€” Zod ìŠ¤í‚¤ë§ˆ (47ì¤„)
- `src/app/(dashboard)/admin/users/page.tsx` â€” ëª©ë¡ í˜ì´ì§€ (75ì¤„)
- `src/app/(dashboard)/admin/users/_components/user-columns.tsx` â€” ì»¬ëŸ¼ ì •ì˜ (~170ì¤„)
- `src/app/(dashboard)/admin/users/_components/users-toolbar.tsx` â€” í•„í„° íˆ´ë°” (85ì¤„)
- `src/app/(dashboard)/admin/users/_components/role-change-dialog.tsx` â€” ì—­í•  ë³€ê²½ AlertDialog (~90ì¤„)
- `src/app/(dashboard)/admin/users/_components/user-detail-sheet.tsx` â€” ì‚¬ìš©ì ìƒì„¸ Sheet (~130ì¤„)
